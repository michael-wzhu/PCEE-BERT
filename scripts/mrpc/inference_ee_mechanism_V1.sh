
task_name=MRPC
seed=112401

echo "${task_name}"
echo "${seed}"

list_do_ensemble=(0)
#exiting_threshold_lst=(0.05263157894736842 0.10526315789473684 0.15789473684210525 0.21052631578947367 0.2631578947368421 0.3157894736842105 0.3684210526315789 0.42105263157894735 0.47368421052631576 0.5263157894736842 0.5789473684210527 0.631578947368421 0.6842105263157894 0.7368421052631579 0.7894736842105263 0.8421052631578947 0.894736842105263 0.9473684210526315 1.0)
exiting_threshold_lst=(0.05555555555555555 0.1111111111111111 0.16666666666666666 0.2222222222222222 0.2777777777777778 0.3333333333333333 0.38888888888888884 0.4444444444444444 0.5)
#exiting_threshold_lst=(0.5 0.5208333333333334 0.5416666666666666 0.5625 0.5833333333333334 0.6041666666666666 0.625 0.6458333333333333 0.6666666666666666 0.6875 0.7083333333333333 0.7291666666666666 0.75 0.7708333333333333 0.7916666666666666 0.8125 0.8333333333333333 0.8541666666666666 0.875 0.8958333333333333 0.9166666666666666 0.9375 0.9583333333333333 0.9791666666666666 1.0)
#exiting_threshold_lst=(0.625 0.6458333333333333 0.6666666666666666 0.6875 0.7083333333333333 0.7291666666666666 0.75 0.7708333333333333 0.7916666666666666 0.8125 0.8333333333333333 0.8541666666666666 0.875 0.8958333333333333 0.9020408163265307 0.9040816326530613 0.9061224489795918 0.9081632653061225 0.9102040816326531 0.9122448979591837 0.9142857142857143 0.9163265306122449 0.9183673469387755 0.9204081632653062 0.9224489795918368 0.9244897959183673 0.926530612244898 0.9285714285714286 0.9306122448979592 0.9326530612244898 0.9346938775510204 0.936734693877551 0.9387755102040817 0.9408163265306123 0.9428571428571428 0.9448979591836735 0.9469387755102041 0.9489795918367347 0.9510204081632653 0.9530612244897959 0.9551020408163265 0.9571428571428572 0.9591836734693878 0.9612244897959183 0.963265306122449 0.9653061224489796 0.9673469387755103 0.9693877551020408 0.9714285714285714 0.9734693877551021 0.9755102040816327 0.9775510204081632 0.9795918367346939 0.9816326530612245 0.9836734693877551 0.9857142857142858 0.9877551020408163 0.9897959183673469 0.9918367346938776 0.9938775510204082 0.9959183673469387 0.9979591836734694 1.0)

for do_ensemble in ${list_do_ensemble[@]}
do
    for e_thres in ${exiting_threshold_lst[@]}
    do
        echo ${e_thres}
        CUDA_VISIBLE_DEVICES="0" python examples/research_projects/pabee_with_entropy/run_glue_with_pabee.py \
            --seed ${seed} \
            --task_name $task_name \
            --data_dir datasets/glue/${task_name}/ \
            --model_type bert \
            --model_name_or_path bert-base-uncased \
            --output_dir experiments/pabee_with_entropy/outputs/bert_${task_name}_${seed} \
            --max_seq_length 128 \
            --do_eval \
            --eval_all_checkpoints \
            --do_lower_case \
            --per_gpu_train_batch_size 16 \
            --per_gpu_eval_batch_size 1 \
            --learning_rate 1e-5 \
            --linear_learning_rate 1e-5 \
            --num_train_epochs 20 \
            --warmup_steps 200 --logging_steps 100 --save_steps 200 \
            --overwrite_output_dir --overwrite_cache \
            --gradient_checkpointing \
            --weights_schema asc \
            --ee_mechanism V1 \
            --metric_key acc_and_f1 \
            --exiting_threshold ${e_thres} \
            --do_ensemble ${do_ensemble} \
            --patience 2
    done
done


# 2,3,4,5,6,7,8,9,10,11